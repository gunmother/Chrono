<!-- W-99 START (full build) -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Chrono</title>
<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#000000" />
<style>
  :root{
    --bg:#e3eaf2; --ink:#7a8ba2;
    --icon-inactive:#7a8ba2; --icon-active:#4ff7ff;
    --pressed-navy:#355169; --turq-glow: rgba(79,247,255,.32);
    --off:5px; --blur:9px; --hi:#ffffff; --lo:#b7c3d1;
    --gap:24px; --radius:12px;
    --border:#c6cfda; --grid-line:#cfd9e5;
    --chart-bg:#d1dce8; --mask-surface: var(--bg);
    --hour-col:64px; --dow-h:32px; --label-size:12px;
    --marquee-border:5px;
    --marquee-glow:0 0 9px 4px var(--turq-glow);
    --handle-stroke:#5e7286;
    --chev-stroke-w:2.2;
    --handle-gap:12px;
    --handle-height-mult:1.75;
    --stamp-h:26px;
  }
  html,body{height:100%;margin:0;background:var(--bg);color:var(--ink);font:500 16px/1.4 system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;overflow:hidden;-webkit-tap-highlight-color:transparent;}
  *{box-sizing:border-box}
  .app{width:clamp(320px,96vw,520px);height:calc(100svh - max(16px,env(safe-area-inset-top)) - max(16px,env(safe-area-inset-bottom)));margin:max(16px,env(safe-area-inset-top)) auto;display:flex;flex-direction:column;gap:var(--gap);padding:0 var(--gap);}
  #screen{flex:1;min-height:420px;border-radius:var(--radius);background:var(--bg);box-shadow:calc(-1*var(--off)) calc(-1*var(--off)) var(--blur) var(--hi),var(--off) var(--off) var(--blur) var(--lo);position:relative;overflow:hidden;display:grid;place-items:center;}
  .controls{display:flex;gap:var(--gap);padding-bottom:2px;}
  .neu-btn{--btn-d:calc((100% - (3*var(--gap)))/4);flex:0 0 var(--btn-d);width:var(--btn-d);aspect-ratio:1/1;border-radius:50%;border:none;cursor:pointer;background:var(--bg);display:grid;place-items:center;box-shadow:calc(-1*var(--off)) calc(-1*var(--off)) var(--blur) var(--hi),var(--off) var(--off) var(--blur) var(--lo);}
  .neu-btn svg{width:86%;height:auto;stroke:var(--icon-inactive);stroke-width:1.25;fill:none;stroke-linecap:round;stroke-linejoin:round;}
  .neu-btn.is-pressed{background:var(--pressed-navy);}
  .neu-btn.is-pressed svg{stroke:var(--icon-active);}
  .selBtns{position:fixed;z-index:8;display:grid;gap:8px;}
  .stamp{position:absolute;left:50%;transform:translateX(-50%);background:var(--pressed-navy);color:var(--icon-active);border:1px solid #273b4d;border-radius:10px;padding:4px 8px;font-size:12px;font-variant-numeric:tabular-nums;font-weight:900;white-space:nowrap;pointer-events:none;box-shadow:0 0 2px rgba(79,247,255,.28),0 0 10px rgba(79,247,255,.28);}
  .ghost{position:fixed;z-index:30;pointer-events:auto;border-radius:10px;opacity:.5;box-shadow:inset 0 0 0 2px rgba(0,0,0,.1);touch-action:none;}
  .ghost.valid{background:#00c853;}
  .ghost.invalid{background:#ff5252;}
  .ghost-stamp{position:absolute;left:50%;transform:translateX(-50%);background:var(--pressed-navy);color:var(--icon-active);border:1px solid #273b4d;border-radius:10px;padding:2px 6px;font-size:11px;font-weight:700;white-space:nowrap;pointer-events:none;}
</style>
</head>
<body>
  <main class="app">
    <section id="screen">Chrono W-99</section>
    <nav class="controls">
      <button class="neu-btn" data-view="day" title="Day"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="5.5"/></svg></button>
      <button class="neu-btn" data-view="week" title="Week"><svg viewBox="0 0 24 24"><rect x="3" y="4.5" width="18" height="15" rx="3"/></svg></button>
      <button class="neu-btn" data-view="month" title="Month"><svg viewBox="0 0 24 24"><rect x="3" y="4.5" width="18" height="15" rx="3"/></svg></button>
      <button class="neu-btn" data-view="todo" title="To-Do"><svg viewBox="0 0 24 24"><rect x="4" y="5" width="16" height="14" rx="3"/></svg></button>
    </nav>
  </main>
<script>
const screenEl=document.getElementById('screen');
const buttons=[...document.querySelectorAll('.neu-btn')];
let activeView=null;
let blocks=[{id:'b1',weekSt:0,startAbs:60,dur:120,catKey:'work'}];
let selectedBlockId=null;
let ghost=null;

function HHMM(min){const m=((Math.round(min)|0)+1440)%1440;const h=Math.floor(m/60),r=m%60;return `${String(h).padStart(2,'0')}:${String(r).padStart(2,'0')}`;}

buttons.forEach(btn=>{
  btn.addEventListener('click',()=>{
    buttons.forEach(x=>x.classList.remove('is-pressed'));
    btn.classList.add('is-pressed');
    activeView=btn.dataset.view;
    render();
  });
});

function render(){
  if(activeView==='week'){
    buildWeek();
  }else{
    screenEl.innerHTML=`<div>${activeView||'screensaver'}</div>`;
  }
}
function buildWeek(){
  screenEl.innerHTML='<div id="weekGrid" style="position:relative;width:100%;height:100%;background:#fff"></div>';
  const host=document.getElementById('weekGrid');
  blocks.forEach(b=>{
    const el=document.createElement('div');
    el.className='blk';
    el.style.position='absolute';
    el.style.left='20%';
    el.style.top=(b.startAbs/1440*100)+'%';
    el.style.width='60%';
    el.style.height=(b.dur/1440*100)+'%';
    el.style.background='#4aa0d6';
    el.onclick=(e)=>{e.stopPropagation();selectBlock(b.id,el.getBoundingClientRect());};
    host.appendChild(el);
  });
  host.onclick=()=>{selectedBlockId=null;destroyActionButtons();};
}
function selectBlock(id,rect){
  selectedBlockId=id;
  ensureActionButtons('block');
  showBlockTimestamps(rect);
}
function showBlockTimestamps(rect){
  removeBlockTimestamps();
  const top=document.createElement('div');top.className='stamp';top.textContent=HHMM(blocks.find(b=>b.id===selectedBlockId).startAbs);top.style.top=(rect.top-30)+'px';top.style.left=rect.left+rect.width/2+'px';top.style.position='fixed';
  const bot=document.createElement('div');bot.className='stamp';bot.textContent=HHMM(blocks.find(b=>b.id===selectedBlockId).startAbs+blocks.find(b=>b.id===selectedBlockId).dur);bot.style.top=(rect.bottom+5)+'px';bot.style.left=rect.left+rect.width/2+'px';bot.style.position='fixed';
  top.id='blkStampTop';bot.id='blkStampBot';document.body.appendChild(top);document.body.appendChild(bot);
}
function removeBlockTimestamps(){document.getElementById('blkStampTop')?.remove();document.getElementById('blkStampBot')?.remove();}
function ensureActionButtons(ctx){
  destroyActionButtons();
  const wrap=document.createElement('div');wrap.className='selBtns';wrap.id='actionBtns';wrap.style.top='50%';wrap.style.right='10px';
  const dragBtn=document.createElement('button');dragBtn.textContent='Drag';dragBtn.onclick=()=>toggleGhost('drag');
  wrap.appendChild(dragBtn);
  document.body.appendChild(wrap);
}
function destroyActionButtons(){document.getElementById('actionBtns')?.remove();}
function toggleGhost(mode){
  if(ghost){commitGhost();removeGhost();return;}
  const blk=blocks.find(b=>b.id===selectedBlockId);if(!blk)return;
  ghost={mode,startAbs:blk.startAbs,dur:blk.dur,valid:true};
  drawGhost();
}
function drawGhost(){
  removeGhost();
  const rect=absToRect(ghost.startAbs,ghost.dur);
  const el=document.createElement('div');el.className='ghost valid';
  el.style.left=rect.left+'px';el.style.top=rect.top+'px';el.style.width=rect.width+'px';el.style.height=rect.height+'px';
  el.onpointerdown=(e)=>{e.preventDefault();el.setPointerCapture(e.pointerId);const offsetY=e.clientY-(rect.top+rect.height/2);
    el.onpointermove=(ev)=>{const center=ev.clientY-offsetY;const newStart=(center-rect.top)/rect.height*ghost.dur;ghost.startAbs=Math.max(0,Math.min(1440-ghost.dur,newStart));updateGhost(el);};
    el.onpointerup=()=>{el.onpointermove=null;};};
  document.body.appendChild(el);
  addGhostTimestamps(el,rect);
}
function addGhostTimestamps(el,rect){
  const top=document.createElement('div');top.className='ghost-stamp';top.textContent=HHMM(ghost.startAbs);top.style.top=(rect.top-20)+'px';top.style.left=rect.left+rect.width/2+'px';top.id='ghostStampTop';
  const bot=document.createElement('div');bot.className='ghost-stamp';bot.textContent=HHMM(ghost.startAbs+ghost.dur);bot.style.top=(rect.top+rect.height+2)+'px';bot.style.left=rect.left+rect.width/2+'px';bot.id='ghostStampBot';
  document.body.appendChild(top);document.body.appendChild(bot);
}
function updateGhost(el){
  const rect=absToRect(ghost.startAbs,ghost.dur);
  el.style.top=rect.top+'px';el.style.height=rect.height+'px';
  document.getElementById('ghostStampTop').style.top=(rect.top-20)+'px';document.getElementById('ghostStampTop').textContent=HHMM(ghost.startAbs);
  document.getElementById('ghostStampBot').style.top=(rect.top+rect.height+2)+'px';document.getElementById('ghostStampBot').textContent=HHMM(ghost.startAbs+ghost.dur);
}
function removeGhost(){document.querySelector('.ghost')?.remove();document.getElementById('ghostStampTop')?.remove();document.getElementById('ghostStampBot')?.remove();ghost=null;}
function commitGhost(){if(!ghost)return;const blk=blocks.find(b=>b.id===selectedBlockId);if(blk){blk.startAbs=ghost.startAbs;}}
function absToRect(startAbs,dur){const host=screenEl.getBoundingClientRect();const top=host.top+(startAbs/1440*host.height);const height=(dur/1440*host.height);return{left:host.left+host.width*0.2,top,width:host.width*0.6,height};}

render();
</script>
</body>
</html>
<!-- W-99 EOF -->